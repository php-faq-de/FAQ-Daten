<p>
In diesem Beispiel wird die HTML-Datei über den
<a href="http://www.php3.de/file">file()</a>-Befehl vom entfernten Server gezogen.
Die Funktion <tt>absolute()</tt> erwartet als ersten Parameter
einen Link und als zweiten Parameter die volle URL des Dokuments,
in dem sich der Link befindet. Sie kann auch in einem anderen
Kontext verwendet werden. Obwohl viele der Anweisungen
(z.B. <a href="http://www.php3.de/substr">substr()</a> oder <a href="http://www.php3.de/strrpos">strrpos()</a>) auch über reguläre Ausdrücke gelöst werden
können, wurde aus Performance-Gründen bewusst darauf verzichtet.
</p>

<pre>&lt;?php
// Datei über HTTP aufrufen
$url = 'http://www.server.de/test.html';
$old = implode&#40;'', file&#40;$url&#41;&#41;;
&nbsp;
// Links suchen und an absolute() weiterleiten
$new = preg_replace&#40;',&lt;a([^&gt;]+)href=&quot;([^&gt;&quot;\s]+)&quot;,ie',
    '&quot;&lt;a\1href=\"&quot; . absolute(&quot;\2&quot;, $url) . &quot;\"&quot;',
    $old&#41;;
&nbsp;
// HTML-Code ausgeben
header&#40;'Content-type: text/plain'&#41;;
echo $new;
&nbsp;
// Funktion, die relative in absolute Links umschreibt
function absolute &#40;$relative, $absolute&#41; &#123;
&nbsp;
    // Link ist schon absolut
    if &#40;preg_match&#40;',^(https?://|ftp://|mailto:|news:),i', $relative&#41;&#41;
        return $relative;
&nbsp;
    // parse_url() nimmt die URL auseinander
    $url = parse_url&#40;$absolute&#41;;
&nbsp;
    // dirname() erkennt auf / endende URLs nicht
    if &#40;$url&#91;'path'&#93;&#123;strlen&#40;$url&#91;'path'&#93;&#41; - 1&#125; == '/'&#41;
        $dir = substr&#40;$url&#91;'path'&#93;, 0, strlen&#40;$url&#91;'path'&#93;&#41; - 1&#41;;
    else
        $dir = dirname&#40;$url&#91;'path'&#93;&#41;;
&nbsp;
    // absoluter Link auf dem gleichen Server
    if &#40;$relative&#123;0&#125; == '/'&#41; &#123;
        $relative = substr&#40;$relative, 1&#41;;
        $dir = '';
    &#125;
&nbsp;
    // Link fängt mit ./ an
    elseif &#40;substr&#40;$relative, 0, 2&#41; == './'&#41;
        $relative = substr&#40;$relative, 2&#41;;
&nbsp;
    // Referenzen auf höher liegende Verzeichnisse auflösen
    else while &#40;substr&#40;$relative, 0, 3&#41; == '../'&#41; &#123;
        $relative = substr&#40;$relative, 3&#41;;
        $dir = substr&#40;$dir, 0, strrpos&#40;$dir, '/'&#41;&#41;;
    &#125;
&nbsp;
    // volle URL zurückgeben
    return sprintf&#40;'%s://%s%s/%s', $url&#91;'scheme'&#93;, $url&#91;'host'&#93;, $dir, $relative&#41;;
&#125;
?&gt;</pre>

